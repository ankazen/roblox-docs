<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <link rel="canonical" href="https://developer.roblox.com/articles/CFrame-Math-Operations"/>
    <link rel="alternate" hreflang="x-default" href="https://developer.roblox.com/articles/CFrame-Math-Operations"/>
    
      <link rel="alternate" hreflang="en-us" href="https://developer.roblox.com/en-us/"/>
    
      <link rel="alternate" hreflang="zh-cn" href="https://developer.roblox.com/zh-cn/"/>
    
      
        
          <title> CFrame 数学运算</title>
        
      

      
        
      

      <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta class="swiftype" name="locale" data-type="string" content="zh-cn">



<meta name="description" content="<p>一组用于 CFrame 操作的常见数学运算</p>">



<meta name="keywords" content="">


<meta name="author" content="Roblox">



	<meta class="swiftype" name="title" data-type="string" content="CFrame 数学运算">
	<meta class="swiftype" name="summary" data-type="string" content="<p>一组用于 CFrame 操作的常见数学运算</p>">
	<meta class="swiftype" name="segment" data-type="string" content="articles">
	<meta class="swiftype" name="category" data-type="string" content="编码与脚本">
	<meta class="swiftype" name="hide_from_search" data-type="string" content="">





       
  </head>
  <body>
    

<!-- Evidon Tag Management -->
<script type="text/javascript" src="https://dk135eecbplh9.cloudfront.net/public/js/evidon.js"></script>

<!-- Favicon -->
<link rel="shortcut icon" href="https://dk135eecbplh9.cloudfront.net/public/images/favicon.ico" type="image/x-icon">
<link rel="icon" href="https://dk135eecbplh9.cloudfront.net/public/images/favicon.ico" type="image/x-icon" />

<!-- Sentry.io -->
<script src="https://browser.sentry-cdn.com/5.12.1/bundle.min.js"
	integrity="sha384-y+an4eARFKvjzOivf/Z7JtMJhaN6b+lLQ5oFbBbUwZNNVir39cYtkjW1r6Xjbxg3"
	crossorigin="anonymous"></script>
<script type="text/javascript">
	Sentry.init({ dsn: 'https://d22e972d03124ce6b4468bfd38f6bfde@sentry.io/2246250' });
</script>

<link href="https://dk135eecbplh9.cloudfront.net/public/css/prettify.css" rel="stylesheet" type="text/css">
<link href="https://dk135eecbplh9.cloudfront.net/public/css/select2.css" rel="stylesheet" type="text/css">
<link href="https://dk135eecbplh9.cloudfront.net/public/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href="https://dk135eecbplh9.cloudfront.net/public/css/main.css" rel="stylesheet" type="text/css">

<script src="https://dk135eecbplh9.cloudfront.net/public/js/jquery-3.3.1.min.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/popper.min.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/jPages.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/bootstrap.min.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/bootstrap-toc.js"></script>
<!-- <script src="https://dk135eecbplh9.cloudfront.net/public/js/docs.min.js"></script> -->
<script src="https://dk135eecbplh9.cloudfront.net/public/js/prettify.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/lang-lua.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/select2.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/clipboard.min.js"></script>

<script src="https://dk135eecbplh9.cloudfront.net/public/js/autolinking.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/lightbox.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/half-sized.js"></script>
<script src="https://cdn.knightlab.com/libs/juxtapose/latest/js/juxtapose.min.js"></script>
<link rel="stylesheet" href="https://cdn.knightlab.com/libs/juxtapose/latest/css/juxtapose.css">

<script type="text/javascript" src="https://dk135eecbplh9.cloudfront.net/public/js/jquery.cookie.js"></script>
<script type="text/javascript" src="https://dk135eecbplh9.cloudfront.net/public/js/encrypt-md5.js"></script>
<!-- <script type="text/javascript" src="https://dk135eecbplh9.cloudfront.net/public/js/gdpr.js"></script> -->

<script src="https://dk135eecbplh9.cloudfront.net/public/js/script.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/codesample-theme.js"></script>
<script src="https://dk135eecbplh9.cloudfront.net/public/js/code-highlighting.js"></script>
<!-- <script src="https://dk135eecbplh9.cloudfront.net/public/js/local-codesamples.js"></script> -->
<script src="https://dk135eecbplh9.cloudfront.net/public/js/language-dropdown.js"></script>

<script src="https://dk135eecbplh9.cloudfront.net/public/js/event_template_one.js"></script>

<script type="text/javascript" src="https://dk135eecbplh9.cloudfront.net/public/js/jquery.swiftype.autocomplete.js">
</script>
<script type='text/javascript' src='https://dk135eecbplh9.cloudfront.net/public/js/jquery.ba-hashchange.min.js'></script>
<script type="text/javascript" src="https://dk135eecbplh9.cloudfront.net/public/js/jquery.swiftype.search.js"></script>
<script type="text/javascript" src="https://dk135eecbplh9.cloudfront.net/public/js/jquery.swiftype.livesearch.js">
</script>

<script type="text/javascript" src="https://dk135eecbplh9.cloudfront.net/public/js/st.custom.search.js"
	engineID="PcoWSkbVqDnWTu_dm2ix"></script>
<span class="d-none swiftype-engine-id">PcoWSkbVqDnWTu_dm2ix</span>

    
  <div class="main-container learn-roblox-pages sub-pages">
    
  

  

  <div class="header-wrap clearfix no-print">
    <nav class="header navbar navbar-expand-lg navbar-light bd-navbar" data-swiftype-index='false'>
      <div class="d-flex">
        <span class="d-lg-none toggler-icon">&#9776;</span>
      </div>

      <div class="logo">
        <a style="background-image: url('https://dk135eecbplh9.cloudfront.net/assets/blta0080185413748f5/logo.png');" href="/" target="_self">
        </a>
      </div>
      <div class="wrap">
        <div class="slide-overlay"></div>
        <div class="navbar-collapse">
          <div class="navbar-inner">
            <span class="d-lg-none closebtn">&times;</span>
            <div class="nav-wrap">
              <p class="d-lg-none home-link"><a href="/">主页</a></p>
              <ul class="navbar-nav bd-navbar-nav">
                <div class="relevant-sidebar">
                  
                    <div class="d-none d-lg-block bd-sidebar" data-swiftype-index='false'>
  <span class="back-icon">
    <span><img class="l-arrow" src="https://dk135eecbplh9.cloudfront.net/public/images/l-arrow.svg"/></span>
  </span>
  <nav class="bd-links" id="bd-docs-nav">
    <div class="bd-toc-item-wrap">
      <h5 class="bd-toc-heading">教程</h5>
      <div>
        
          
        
          
        
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/studio-basics">
                <span>Studio 基础知识</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/creating">
                <span>创建</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/international">
                <span>国际化</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/sound-lighting-fx">
                <span>声效、光照与特效</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/marketing">
                <span>市场营销</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/optimization">
                <span>性能优化</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/all-tutorials">
                <span>所有内容</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/analytics">
                <span>数据分析</span>
              </a>
            </div>
          
        
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/user-interface">
                <span>用户界面</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/monetization">
                <span>盈利</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/coding-scripts">
                <span>编码与脚本</span>
              </a>
            </div>
          
        
          
            <div class="bd-toc-item learn-roblox-tutorial">
              <a class="bd-toc-link" href="/learn-roblox/cross-platform">
                <span>跨平台发展</span>
              </a>
            </div>
          
        
      </div>
    </div>
  </nav>
</div>

                  
                </div>
                
                  <li class="nav-item">
                    <a class="nav-link" target="_self" href="/quick-start">
                      <span>入门</span>
                      <img class="r-arrow" src="https://dk135eecbplh9.cloudfront.net/public/images/r-arrow.svg"/>
                    </a>
                  </li>
                
                  <li class="nav-item">
                    <a class="nav-link" target="_self" href="/learn-roblox/all-tutorials">
                      <span>了解 Roblox</span>
                      <img class="r-arrow" src="https://dk135eecbplh9.cloudfront.net/public/images/r-arrow.svg"/>
                    </a>
                  </li>
                
                  <li class="nav-item">
                    <a class="nav-link" target="_self" href="/api-reference">
                      <span>API 参考</span>
                      <img class="r-arrow" src="https://dk135eecbplh9.cloudfront.net/public/images/r-arrow.svg"/>
                    </a>
                  </li>
                
                  <li class="nav-item">
                    <a class="nav-link" target="_self" href="/resources">
                      <span>资源</span>
                      <img class="r-arrow" src="https://dk135eecbplh9.cloudfront.net/public/images/r-arrow.svg"/>
                    </a>
                  </li>
                
                  <li class="nav-item">
                    <a class="nav-link" target="_blank" href="https://devforum.roblox.com">
                      <span>社区</span>
                      <img class="r-arrow" src="https://dk135eecbplh9.cloudfront.net/public/images/r-arrow.svg"/>
                    </a>
                  </li>
                
              </ul>
               <a class="dwd-link d-lg-none" target="_self" href="">
                
              </a>
            </div>
          </div>
          <div class="actions-wrap">
            <a class="dwd-link" target="_self" href="">
                
            </a>
            <span class="m-search-icon"></span>
            <div class="search-box">

                <form class="d-flex align-items-center" id="search-form">
                   <input class="form-control" name="s" type="search" id="st-search-input" placeholder="搜索">
                    <button class="btn-submit" type="submit"><i class="search-icon"></i></button>
                </form>
                <a href="javascript:void(0)" class="search-close">&times;</a>
                <div id="searchDropdown" class="search-content">
                  <div class="search-content-inner">
                    <div class="inner-scroll">
                      <div class="categories">
                        <span class="lbl">Articles</span>
                        <ul>
                          <li>Animation in player script</li>
                          <li>Animation handler</li>
                          <li>Bubbly Animation Package</li>
                        </ul>
                      </div>
                      <div class="categories">
                        <span class="lbl">API Refernce</span>
                        <ul>
                          <li>animationController</li>
                          <li>animationID</li>
                          <li>Bubbly Animation Package</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
            </div>
          </div>
        </div>
      </div>
    </nav>
  </div>





 		<div class="container-fluid">
      <div class="row flex-xl-nowrap">
        

  <div class="d-none d-lg-block bd-sidebar-wrap" data-swiftype-index='false'>
    <div class="flex-wrapper">
      <span class="toggle-sidebar sm-toggle collapse-slide">
        <a href="javascript:void(0)" class="arrow-right">
          <i class="arrow arrow-r"></i>
        </a>
      </span>
      <div class="slide-sidebar">
       <span class="toggle-sidebar expanded-slide">
          <a href="javascript:void(0)" class="">
            <i class="arrow arrow-l"></i>
            <span class="txt">关闭侧边栏</span>
          </a>
       </span>
        <div class="bd-sidebar" data-swiftype-index='false'>
          <span class="back-icon">
            <span><img class="l-arrow" src="https://dk135eecbplh9.cloudfront.net/public/images/l-arrow.svg"/></span>
          </span>
          <nav class="bd-links" id="bd-docs-nav">
            <div class="bd-toc-item-wrap">
              <h5 class="bd-toc-heading">教程</h5>
              <div>
                
                  
                
                  
                
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/studio-basics">
                      <span>Studio 基础知识</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/creating">
                      <span>创建</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/international">
                      <span>国际化</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/sound-lighting-fx">
                      <span>声效、光照与特效</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/marketing">
                      <span>市场营销</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/optimization">
                      <span>性能优化</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/all-tutorials">
                      <span>所有内容</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/analytics">
                      <span>数据分析</span>
                    </a>
                  </div>
                  
                
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/user-interface">
                      <span>用户界面</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/monetization">
                      <span>盈利</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/coding-scripts">
                      <span>编码与脚本</span>
                    </a>
                  </div>
                  
                
                  
                  <div class="bd-toc-item learn-roblox-tutorial">
                    <a class="bd-toc-link" href="/learn-roblox/cross-platform">
                      <span>跨平台发展</span>
                    </a>
                  </div>
                  
                
              </div>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>



        <div class="w-100 d-md-none d-lg-none d-xl-none">
          <div class="m-heading">
            
<ol class="breadcrumb" data-swiftype-index='false'>
  
    
    <li class="breadcrumb-item">
      <a href="/learn-roblox/all-tutorials">学习 ROBLOX</a>
    </li>
    
  
    
    <li class="breadcrumb-item">
      <a href="/learn-roblox/coding-scripts">编码与脚本</a>
    </li>
    
  
</ol>

            <h1 data-toc-skip>CFrame 数学运算</h1>
          </div>
        </div>
        
        

<div class="d-xl-block bd-toc-wrap">
  <div class="bd-toc">
    <a href="javascript:void(0)" class="toggle-toc hide-toc">
      <i class="fa fa-angle-down"></i>
      <span class="toggle-txt">隐藏内容索引</span>
    </a>
    <a href="javascript:void(0)" class="toggle-toc show-toc invisible">
      <i class="fa fa-angle-down"></i>
      <span class="toggle-txt">显示内容索引</span>
    </a>
    <div class="toc-nav">
      <div class="inner-toc-nav">
        <div class="toc-content"><a href="javascript:void(0)">内容索引</a>
        </div>
        <nav id="toc">
        </nav>
      </div>
    </div>
  </div>
</div>



        <main class="bd-content" data-swiftype-name="body" data-swiftype-type="text" data-swiftype-index='true'>
          <div class="l-content toc-scope">
            <div class="d-none d-md-block d-lg-block d-xl-block">
              
<ol class="breadcrumb" data-swiftype-index='false'>
  
    
    <li class="breadcrumb-item">
      <a href="/learn-roblox/all-tutorials">学习 ROBLOX</a>
    </li>
    
  
    
    <li class="breadcrumb-item">
      <a href="/learn-roblox/coding-scripts">编码与脚本</a>
    </li>
    
  
</ol>

              <h1 data-toc-skip data-swiftype-index='false'>CFrame 数学运算</h1>
            </div>
            <p class="timestamp-wrap" data-swiftype-index='false'>
              
                <span class="time">15  分钟</span>
              
            </p>

            
            <div class="article-details">
              
                




   
    
      <div class="markdown-field-data">
        <div class="alert alert-danger" role="alert">
阅读本文章前需要具备较为深厚的向量和向量数学知识。请刚接触 <samp>CFrame</samp> 的开发者先从<code>articles/Understanding CFrame|了解 CFrames</code>一文开始阅读。
</div>
<h2>CFrame 的分量</h2>
<p>每个 CFrame 都由 12 个单独的数字组成，我们称其为分量。当需要获取这些数字时，只需调用能够将其作为结果返回的 <code>CFrame:components()</code> 方法即可。</p>
<pre><code class="language-lua">local x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33 = cf:components()
</code></pre>
<p>当定义 CFrame 时，开发者也可以直接输入这 12 个数字。</p>
<pre><code class="language-lua">local cf = CFrame.new(x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33)
</code></pre>
<p>12 个数字中的前三个分别为 CFrame 的 x、y 和 z 分量，也就是其中包含的坐标位置。剩余的数字组成了 CFrame 的旋转方位。这些数字看上去可能有些复杂，但当我们对其换个方式稍加整理就会发现，这些数列分别代表的是 rightVector、upVector 和负 lookVector。</p>
<pre><code class="language-lua">local cf = CFrame.new(0, 0, 0)
local x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33 = cf:components()

-- m11, m12, m13,
-- m21, m22, m23,
-- m31, m32, m33

local right = Vector3.new(m11, m21, m31) -- 与 cf.rightVector 相同
local up = Vector3.new(m12, m22, m32) -- 与 cf.upVector 相同
local back = Vector3.new(m13, m23, m33) -- 与 -cf.lookVecto 相同
</code></pre>
<p>对这些向量进行视觉化后，我们将可以更轻易地体会 CFrame 旋转数值的实际效果。从下图中可以看到这些数字代表的是三个正交向量，它们共同描绘了一个 3D 球体状旋转范围。</p>
<p><img src="/assets/blt0d5070611917410a/CFrameMath_rotationVectors-compressor.gif" alt="CFrame Axes"></p>
<h2>CFrame * CFrame</h2>
<p>CFrame 实际上是采用以下形式的 4x4 矩阵：</p>
<p><img src="/assets/blt13db5c99d3faf61f/CFrameMath_cf4x4.png" alt="CFrameMath_cf4x4.png"></p>
<!--
\begin{bmatrix}
m_{11} & m_{12} & m_{13} & x \\ 
m_{21} & m_{22} & m_{23} & y \\ 
m_{31} & m_{32} & m_{33} & z \\ 
0 & 0 & 0 & 1 
\end{bmatrix}
-->
<p>也就是说，我们只需将两个 4x4 的矩阵相乘，就能轻松地将两个 CFrame 相乘！</p>
<p><img src="/assets/bltd549ef4a34baeda7/CFrameMath_cf4x4Multiply2.png" alt="CFrameMath_cf4x4Multiply2.png"></p>
<!--
\begin{align*}
cf_a*cf_b&=\begin{bmatrix}
a_{11} & a_{12} & a_{13} & a_{14} \\ 
a_{21} & a_{22} & a_{23} & a_{24} \\ 
a_{31} & a_{32} & a_{33} & a_{34} \\ 
0 & 0 & 0 & 1
\end{bmatrix} * \begin{bmatrix}
b_{11} & b_{12} & b_{13} & b_{14} \\ 
b_{21} & b_{22} & b_{23} & b_{24} \\ 
b_{31} & b_{32} & b_{33} & b_{34} \\ 
0 & 0 & 0 & 1
\end{bmatrix}\\&=\begin{bmatrix}
a_{11}b_{11}+a_{12}b_{21}+a_{13}b_{31} & a_{11}b_{12}+a_{12}b_{22}+a_{13}b_{32} & a_{11}b_{13}+a_{12}b_{23}+a_{13}b_{33} & a_{11}b_{14}+a_{12}b_{24}+a_{13}b_{34}+a_{14} \\ 
a_{21}b_{11}+a_{22}b_{21}+a_{23}b_{31} & a_{21}b_{12}+a_{22}b_{22}+a_{23}b_{32} & a_{21}b_{13}+a_{22}b_{23}+a_{23}b_{33} & a_{21}b_{14}+a_{22}b_{24}+a_{23}b_{34}+a_{24}\\ 
a_{31}b_{11}+a_{32}b_{21}+a_{33}b_{31} & a_{31}b_{12}+a_{32}b_{22}+a_{33}b_{32} & a_{31}b_{13}+a_{32}b_{23}+a_{33}b_{33} & a_{31}b_{14}+a_{32}b_{24}+a_{33}b_{34}+a_{34} \\ 
0 & 0 & 0 & 1
\end{bmatrix}
\end{align*}
-->
<p>这样我们就能编写出用于将两个 CFrame 相乘的函数！</p>
<pre><code class="language-lua">local function multiplyCFrame(a, b)
	local ax, ay, az, a11, a12, a13, a21, a22, a23, a31, a32, a33 = a:components()
	local bx, by, bz, b11, b12, b13, b21, b22, b23, b31, b32, b33 = b:components()
	local m11 = a11*b11+a12*b21+a13*b31
	local m12 = a11*b12+a12*b22+a13*b32
	local m13 = a11*b13+a12*b23+a13*b33
	local x = a11*bx+a12*by+a13*bz+ax
	local m21 = a21*b11+a22*b21+a23*b31
	local m22 = a21*b12+a22*b22+a23*b32
	local m23 = a21*b13+a22*b23+a23*b33
	local y = a21*bx+a22*by+a23*bz+ay
	local m31 = a31*b11+a32*b21+a33*b31
	local m32 = a31*b12+a32*b22+a33*b32
	local m33 = a31*b13+a32*b23+a33*b33
	local z = a31*bx+a32*by+a33*bz+az
	return CFrame.new(x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33)
end
</code></pre>
<p>我们还可以通过循环到达同样的结果：</p>
<pre><code class="language-lua">local function multiply4x4(a, b)
	local out = {}
	for i = 1, 16 do
		out[i] = 0
		local r = math.floor((i-1)/4)+1
		local p = i%4 == 0 and 4 or i%4
		for j = 1, 4 do
			local ai = (r-1)*4+j
			local bi = p+(j-1)*4
			out[i] = out[i] + a[ai]*b[bi]
		end
	end
	return out
end
 
local function multiplyCFrame(a, b)
	local ax, ay, az, a11, a12, a13, a21, a22, a23, a31, a32, a33 = a:components()
	local bx, by, bz, b11, b12, b13, b21, b22, b23, b31, b32, b33 = b:components()
	a = {a11, a12, a13, ax, a21, a22, a23, ay, a31, a32, a33, az, 0, 0, 0, 1}
	b = {b11, b12, b13, bx, b21, b22, b23, by, b31, b32, b33, bz, 0, 0, 0, 1}
	local m11, m12, m13, x, m21, m22, m23, y, m31, m32, m33, z = unpack(multiply4x4(a, b))
	return CFrame.new(x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33)
end
</code></pre>
<p>最后让我们来进行验证测试</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32));

print(cf*cf)
print(multiplyCFrame(cf, cf))
</code></pre>
<pre><code>4.44273901, 3.34623194, 2.4210279, -0.849777162, -0.0723331869, 0.522155881, -0.316965073, 0.861586094, -0.396487743, -0.421203077, -0.502431393, -0.755083263
4.44273901, 3.34623194, 2.4210279, -0.849777162, -0.0723331869, 0.522155941, -0.316965073, 0.861586154, -0.396487743, -0.421203077, -0.502431393, -0.755083263
</code></pre>
<p>进行 CFrame 相乘时有一点十分重要：CFrame 的乘数是不能互换的。换而言之，a * b 并不一定等于 b * a。</p>
<pre><code class="language-lua">local cf1 = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))
local cf2 = CFrame.new(0.1, -10, 6) * CFrame.Angles(math.rad(90), math.rad(-28), math.rad(-86))

print(cf1*cf2)
print(cf2*cf1)
</code></pre>
<pre><code>5.09500504, -7.92827415, 7.54646206, -0.937961817, 0.220474482, -0.26761657, 0.0239842981, -0.728708208, -0.684404194, -0.345908046, -0.64836365, 0.678212643
0.514770269, -13.618248, 5.1419487, 0.162701935, 0.975506902, -0.148035079, 0.94501543, -0.197204709, -0.260875672, -0.283679247, -0.0974504724, -0.953954697
</code></pre>
<p>这项规则也有几种例外情况，其中一种是逆运算，我们稍后再做讨论，而另一种就是我们现在要谈到的身份识别 CFrame。</p>
<p>身份识别 CFrame 如下所示：</p>
<pre><code class="language-lua">local identityCFrame = CFrame.new(0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1)
-- note: CFrame.new(0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1) == CFrame.new()
</code></pre>
<p>如果我们自前或自后用 CFrame 乘以身份识别 CFrame，我们只会得到原来的 CFrame，就像从未进行过乘法运算一样。</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))

print(cf*CFrame.new())
print(CFrame.new()*cf)
</code></pre>
<pre><code>1, 2, 3, 0.262061268, 0.163754046, 0.95105654, -0.319058299, 0.944782019, -0.0747579709, -0.910783052, -0.283851326, 0.299837857
1, 2, 3, 0.262061268, 0.163754046, 0.95105654, -0.319058299, 0.944782019, -0.0747579709, -0.910783052, -0.283851326, 0.299837857
</code></pre>
<h2>CFrame * Vector3</h2>
<p>我们已经知道 CFrame 实际上是 4x4 的矩阵，那么下面就让我们来看看如何将其与向量相乘。CFrame 与 Vector3 的乘法运算用矩阵形式表现是这样的。</p>
<p><img src="/assets/bltf1a4d51278a9ac43/CFrameMath_cfv3Multiply.png" alt="CFrameMath_cfv3Multiply.png"></p>
<!--
\begin{align*}
cf*v3&=\begin{bmatrix}
m_{11} & m_{12} & m_{13} & x \\ 
m_{21} & m_{22} & m_{23} & y \\ 
m_{31} & m_{32} & m_{33} & z \\ 
0 & 0 & 0 & 1 
\end{bmatrix}*\begin{bmatrix}
v_{x}\\ 
v_{y}\\ 
v_{z}\\ 
1
\end{bmatrix} \\
&=\begin{bmatrix}
m_{11}v_{x}+m_{12}v_{y}+m_{13}v_{z}+x\\ 
m_{21}v_{x}+m_{22}v_{y}+m_{23}v_{z}+y\\ 
m_{31}v_{x}+m_{32}v_{y}+m_{33}v_{z}+z\\ 
1
\end{bmatrix}
\end{align*}
-->
<p>因此我们可以编写下列函数</p>
<pre><code class="language-lua">local function multiplycfv3(a, b)
	local x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33 = a:components()
	local vx, vy, vz = b.x, b.y, b.z
	local nx = m11*vx+m12*vy+m13*vz+x
	local ny = m21*vx+m22*vy+m23*vz+y
	local nz = m31*vx+m32*vy+m33*vz+z
	return Vector3.new(nx, ny, nz)
end
</code></pre>
<p>下面让我们再次来进行测试。</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))
local v3 = Vector3.new(5, 6, -12)

print(cf*v3)
print(multiplycfv3(cf, v3))
</code></pre>
<pre><code>-8.11984825, 6.97049618, -6.85507774
-8.11984825, 6.97049618, -6.85507774
</code></pre>
<p>与 CFrame 间互乘不同，CFrame * Vector3 的乘法可以拆分为更加直观的形式。让我们来对表示法稍作调整。</p>
<p><img src="/assets/bltf6737a3183a6d02e/CFrameMath_cfv3Multiply2.png" alt="CFrameMath_cfv3Multiply2.png"></p>
<!--
\begin{bmatrix}
m_{11}v_{x}+m_{12}v_{y}+m_{13}v_{z}+x\\ 
m_{21}v_{x}+m_{22}v_{y}+m_{23}v_{z}+y\\ 
m_{31}v_{x}+m_{32}v_{y}+m_{33}v_{z}+z\\ 
1
\end{bmatrix} = \begin{bmatrix}
x\\ 
y\\ 
z\\ 
1
\end{bmatrix} + v_{x}\begin{bmatrix}
m11\\ 
m21\\ 
m31\\ 
0
\end{bmatrix} +v_{y}\begin{bmatrix}
m12\\ 
m22\\ 
m32\\ 
0
\end{bmatrix} +v_{z}\begin{bmatrix}
m13\\ 
m23\\ 
m33\\ 
0
\end{bmatrix}
-->
<p>是否注意到我们用来与 vx、vy 和 vz 相乘的向量？它们就是我们早些时候学习到的 right、up 和 back 向量！下面让我们来重写函数，反应这一知识。</p>
<pre><code class="language-lua">local function multiplycfv3(a, b)
	return a.p + b.x*a.rightVector + b.y*a.upVector - b.z*a.lookVector
end
</code></pre>
<p>这也有助于我们将运算的实际意义以视觉化方式呈现。</p>
<p><img src="/assets/blt7538fe0aca619bb2/CFrameMath_cfv3MultiplyVisual.png" alt="CFrameMath_cfv3MultiplyVisual.png"></p>
<h2>CFrame + / - Vector3</h2>
<p>在 CFrame 上加上或减去 Vector3 是十分直观的运算。我们只需在 CFrame x、y 和 z 上加/减向量 x、y 和 z，而旋转方位则保持不变。</p>
<pre><code class="language-lua">local function addcfv3(a, b)
	local x, y, z, m11, m12, m13, m21, m22, m23, m31, m32, m33 = a:components()
	return CFrame.new(x + b.x, y + b.y, z + b.z, m11, m12, m13, m21, m22, m23, m31, m32, m33);
end;
</code></pre>
<p>当然也需要进行测试。</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))
local v3 = Vector3.new(5, 6, -12)

print(cf + v3)
print(addcfv3(cf, v3))
</code></pre>
<pre><code>6, 8, -9, 0.262061268, 0.163754046, 0.95105654, -0.319058299, 0.944782019, -0.0747579709, -0.910783052, -0.283851326, 0.299837857
6, 8, -9, 0.262061268, 0.163754046, 0.95105654, -0.319058299, 0.944782019, -0.0747579709, -0.910783052, -0.283851326, 0.299837857
</code></pre>
<h4>CFrame 的逆运算</h4>
<p>CFrame 的逆运算对于大多数人来说都有一定难度。我们将不会在本文中介绍具体如何进行逆运算，而是会着重解说逆运算的使用方法。</p>
<p>我们在 CFrame 互乘章节最后曾提到，乘法的乘数并非总是能够互换。对于乘以派生于自身 CFrame 的 CFrame 逆运算来说，这一条并<strong>不</strong>适用。无论开发者自前还是自后用 CFrame 乘以其逆运算，<strong>始终</strong>都会返回身份识别 CFrame！</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.pi/2, 0, 0)

print(cf*cf:inverse())
print(cf:inverse()*cf)
</code></pre>
<pre><code>0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1
0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1
</code></pre>
<p>运用 CFrame 逆运算的窍门就是写出等式，然后运用我们所掌握的身份识别 CFrame 和 CFrame 乘数不可互换属性等相关知识。让我们来看几个示例。</p>
<h3>还原为初始值</h3>
<p>假设我们有两个 CFrame，并将其相乘得出一个新的 CFrame。</p>
<pre><code class="language-lua">local cf1 = CFrame.new(1, 2, 3) * CFrame.Angles(math.pi/3, math.pi/6, 0)
local cf2 = CFrame.new(-4, 5, 7.2) * CFrame.Angles(0, math.pi/7, -math.pi/3)

local cf = cf1 * cf2
</code></pre>
<p>假设仅给定了 cf 和 cf1，而我们希望求出 cf2。要如何才能做到？要着手解决该问题，我们就要看一下 cf 的等式。</p>
<pre><code class="language-lua">cf = cf1 * cf2
</code></pre>
<p>然后我们就可以应用自己掌握的逆运算知识来求得 cf2。</p>
<pre><code class="language-lua">cf = cf1 * cf2
cf1:inverse() * cf = cf1:inverse() * cf1 * cf2 -- 自前以 cf1:inverse() 相乘等式两边
cf1:inverse() * cf = CFrame.new() * cf2 -- 注意 cf:inverse() * cf = identityCFrame
cf1:inverse() * cf = cf2 -- 注意 identityCFrame * cf = cf
</code></pre>
<p>毫无疑问，我们能通过测试验证这一结果。</p>
<pre><code class="language-lua">local cf1 = CFrame.new(1, 2, 3) * CFrame.Angles(math.pi/3, math.pi/6, 0)
local cf2 = CFrame.new(-4, 5, 7.2) * CFrame.Angles(0, math.pi/7, -math.pi/3)

local cf = cf1*cf2

print(cf2)
print(cf1:inverse() * cf)
</code></pre>
<pre><code>-4, 5, 7.19999981, 0.450484395, 0.780261934, 0.433883756, -0.866025448, 0.49999997, 0, -0.216941863, -0.375754386, 0.90096885
-4, 5.00000143, 7.19999933, 0.450484395, 0.780261934, 0.433883697, -0.866025507, 0.5, -2.98023224e-08, -0.216941863, -0.375754386, 0.90096879
</code></pre>
<p><em>请注意，输出结果中的细微变化是由于浮点数学运算的误差所导致</em></p>
<p>假设我们已知 cf2 和 cf，但 cf1 未知。要求解该问题，我们也可以采用相似的步骤。</p>
<pre><code class="language-lua">cf = cf1 * cf2
cf * cf2:inverse() = cf1 * cf2 * cf2:inverse() -- 自后以 cf2:inverse() 相乘等式两边
cf * cf2:inverse() = cf1 * CFrame.new() -- 注意 cf * cf:inverse() = identityCFrame
cf * cf2:inverse() = cf1 -- 注意 cf * identityCFrame = cf
</code></pre>
<p>再次进行验证测试。</p>
<pre><code class="language-lua">local cf1 = CFrame.new(1, 2, 3) * CFrame.Angles(math.pi/3, math.pi/6, 0)
local cf2 = CFrame.new(-4, 5, 7.2) * CFrame.Angles(0, math.pi/7, -math.pi/3)

local cf = cf1*cf2

print(cf1)
print(cf * cf2:inverse())
</code></pre>
<pre><code>1, 2, 3, 0.866025388, 0, 0.5, 0.433012724, 0.49999997, -0.75, -0.249999985, 0.866025448, 0.433012664
1.00000048, 2.00000048, 3.00000095, 0.866025329, -2.98023224e-08, 0.49999997, 0.433012664, 0.5, -0.75, -0.25000003, 0.866025507, 0.433012664
</code></pre>
<p><em>请注意，结果中的细微变化是由于浮点数学运算的误差所导致</em></p>
<p>或许开发者心中会有这样的疑问：自前与自后相乘究竟为何如此重要？要得知原因所在，让我们来有意识地逐步研究 cf 自前乘以 cf2:inverse() 的整个运算过程，并观察最终的结果。</p>
<pre><code class="language-lua">cf = cf1 * cf2
cf2:inverse() * cf = cf2:inverse() * cf1 * cf2
-- 由于不知道 cf2:inverse() * cf1 = ??? 的答案，所以
cf2:inverse() * cf = ???
</code></pre>
<p>最终的结论就是，顺序是十分重要的，而且我们对等式一侧的处理也必须应用于另一侧，不管是否自前或自后相乘都包括在内！</p>
<h3>门的旋转</h3>
<p>假设我们希望通过 CFrame 实现门的开合。这对于部分学习 CFrame 的人来说可能会十分困难，因为当我们对某一部件的 CFrame 使用 <code>CFrame.Angles</code> 函数并更新时，它会从中心开始转动。</p>
<p><img src="/assets/blt68965f7f24226d28/CFrameMath_doorRotate1.gif" alt="CFrameMath_doorRotate1.gif"></p>
<pre><code class="language-lua">local door = game.Workspace.Door

game:GetService(&quot;RunService&quot;).Heartbeat:connect(function(dt)
	door.CFrame = door.CFrame * CFrame.Angles(0, math.rad(1)*dt*60, 0)
end)
</code></pre>
<p>理想情况下，我们自然希望门能围绕某种铰链转动。也就是说，我们需要寻找一种方法来将我们的铰链作为旋转的中心。我们知道自己能够以类似早先旋转门的方式来旋转铰链。</p>
<p><img src="/assets/blt68e0693617dbe134/CFrameMath_doorRotate2.gif" alt="CFrameMath_doorRotate2.gif"></p>
<pre><code class="language-lua">local door = game.Workspace.Door
local hinge = game.Workspace.Hinge

game:GetService(&quot;RunService&quot;).Heartbeat:connect(function(dt)
	hinge.CFrame = hinge.CFrame * CFrame.Angles(0, math.rad(1)*dt*60, 0)
end)
</code></pre>
<p>如果我们能设法计算出门相对于未旋转铰链的偏移值，就可以将该偏移值应用到旋转的铰链，并得出旋转门的 CFrame。换言之，我们必须在以下运算中求得偏移值：</p>
<pre><code class="language-lua">hinge.CFrame * offset = door.CFrame
</code></pre>
<p>求得偏移值的关键之处，就是使用逆运算！切记，我们对等式一侧的处理也必须应用于另一侧。</p>
<pre><code class="language-lua">hinge.CFrame * offset = door.CFrame -- want to get rid of hinge.CFrame on left side
hinge.CFrame:inverse() * hinge.CFrame * offset = hinge.CFrame:inverse() * door.CFrame -- 因为乘数无法互换，进行自前相乘
CFrame.new() * offset = hinge.CFrame:inverse() * door.CFrame -- cf:inverse() * cf = CFrame.new()
offset = hinge.CFrame:inverse() * door.CFrame -- CFrame.new() * cf = cf
</code></pre>
<p>求出偏移值后，让我们将其应用到旋转铰链上吧！</p>
<p><img src="/assets/blt6bf5320f1c4ca507/CFrameMath_doorRotate3-compressor.gif" alt="CFrameMath_doorRotate3-compressor.gif"></p>
<pre><code class="language-lua">local door = game.Workspace.Door
local hinge = game.Workspace.Hinge

local offset = hinge.CFrame:inverse() * door.CFrame; -- 旋转前首先进行偏移
game:GetService(&quot;RunService&quot;).Heartbeat:connect(function(dt)
	hinge.CFrame = hinge.CFrame * CFrame.Angles(0, math.rad(1)*dt*60, 0) -- 旋转铰链
	door.CFrame = hinge.CFrame * offset -- 将偏移应用至旋转铰链
end)
</code></pre>
<h3>亲自尝试：接合</h3>
<p>接合会受到以下条件约束。</p>
<pre><code class="language-lua">weld.Part0.CFrame * weld.C0 = weld.Part1.CFrame * weld.C1
</code></pre>
<p>请运用我们之前掌握的逆运算知识，尝试求出 Weld.C0 和 Weld.C1。完成自我测试前尽量不要参考答案。</p>
<pre><code class="language-lua">--解决方法：Weld.C0:
weld.Part0.CFrame * weld.C0 = weld.Part1.CFrame * weld.C1 
weld.Part0.CFrame:inverse() * weld.Part0.CFrame * weld.C0 = weld.Part0.CFrame:inverse() * weld.Part1.CFrame * weld.C1 
CFrame.new() * weld.C0 = weld.Part0.CFrame:inverse() * weld.Part1.CFrame * weld.C1 
weld.C0 = weld.Part0.CFrame:inverse() * weld.Part1.CFrame * weld.C1 

--解决方法：C1:
weld.Part0.CFrame * weld.C0 = weld.Part1.CFrame * weld.C1 
weld.Part1.CFrame:inverse() * weld.Part0.CFrame * weld.C0 = weld.Part1.CFrame:inverse() * weld.Part1.CFrame * weld.C1 
weld.Part1.CFrame:inverse() * weld.Part0.CFrame * weld.C0 = CFrame.new() * weld.C1 
weld.Part1.CFrame:inverse() * weld.Part0.CFrame * weld.C0 = weld.C1
</code></pre>
<h2>CFrame 方法</h2>
<p>在最后一节中，我们将探讨每种变换方法及对这些方法的部分直观理解。</p>
<h3>CFrame:ToObjectSpace()</h3>
<p>等同于 <code>CFrame:inverse() * cf</code></p>
<p>其实之前尝试实现门的旋转时，我们就已经从求取偏移值的过程中了解到了该方法的作用。此方法能计算出 CFrame 需要从 <code>CFrame</code> 中取得的偏移值，用以求出 <code>cf</code></p>
<p>开发者可以通过以下函数轻松对其进行验证：</p>
<pre><code class="language-lua">CFrame * CFrame:toObjectSpace(cf)
CFrame * CFrame:inverse() * cf
identityCFrame * cf
cf
</code></pre>
<h3>CFrame:ToWorldSpace()</h3>
<p>等同于 <code>CFrame * cf</code></p>
<p>此方法只是进行 CFrame 乘法，可能会让人觉得有些平凡无奇。不过，该方法的名称可能有助于我们更为直观地理解乘法运算的实际概念。我们在 <code>CFrame:toObjectSpace(cf)</code> 方法中看到，它返回的是两个 CFrame 之间的偏移值。我们还注意到，当我们用 <code>CFrame</code> 乘以偏移值后，最终结果是 <code>cf</code>。那么，我们将两个 CFrame 相乘时，实际上就是将第二个 CFrame 当做了偏移值。</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))
local offset = CFrame.new(0, 0, -10) -- 向前 10 格偏移

print(cf:toWorldSpace(offset)) -- 向前 10 格偏移。记住 cf 的前方为 cf.lookVector
</code></pre>
<pre><code>-8.51056576, 2.74757957, 0.00162148476, 0.262061268, 0.163754046, 0.95105654, -0.319058299, 0.944782019, -0.0747579709, -0.910783052, -0.283851326, 0.299837857
</code></pre>
<h3>CFrame:PointToObjectSpace()</h3>
<p>等同于 <code>CFrame:inverse() * v3</code></p>
<p><img src="/assets/bltf5bc4f61e31171d3/CFrameMath_pointToObjectSpace.gif" alt="CFrameMath_pointToObjectSpace.gif"></p>
<p>此方法会在 3D 空间当中取特定点并使之与 <code>CFrame.p</code> 相对应，然后将其换算为偏移值。</p>
<p>此方法的替代方法为 <code>(CFrame - CFrame.p):inverse() * (v3 - CFrame.p)</code></p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))
local v3 = Vector3.new(10, 10, 15)

print(cf:pointToObjectSpace(v3))
print((cf - cf.p):inverse() * (v3 - cf.p))
</code></pre>
<pre><code>-11.123312, 5.62582684, 11.5594997
-11.123312, 5.62582684, 11.5594997
</code></pre>
<h3>CFrame:PointToWorldSpace()</h3>
<p>等同于 <code>CFrame * v3</code></p>
<p>由于我们早已探讨过了 <code>CFrame * v3</code> 的直观效果，因此除去已知内容外并无太多内容需要赘述。但需要再次进行提醒的是：此方法相当于在没有旋转方位的情况下应用偏移值。</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))
local v3 = Vector3.new(10, 10, 15)

print(cf * cf:pointToObjectSpace(v3))
</code></pre>
<pre><code>10.000001, 10, 15.0000019
</code></pre>
<p><em>请注意，结果中的细微变化是由于浮点数学运算的误差所导致</em></p>
<h3>CFrame:VectorToObjectSpace()</h3>
<p>等同于 <code>(CFrame-CFrame.p):inverse() * v3</code></p>
<p>此方法十分类似于 <code>CFrame:pointObjectSpace(v3)</code> 方法的替代形式。最主要的区别就是 <code>v3</code> 不再减去 <code>CFrame.p</code>。换而言之，两者步骤非常相似，唯一的区别就是不会使 <code>v3</code> 与 <code>CFrame.p</code> 相对应，而是默认之前所输入的 v3 已为相对数值。</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))

print(cf:vectorToObjectSpace(cf.rightVector))
</code></pre>
<pre><code>1.00000012, 2.98023224e-08, 0
</code></pre>
<p><em>请注意，结果中的细微变化是由于浮点数学运算的误差所导致</em></p>
<p>我们可以看到，其结果等于或约等于 Vector3.new(1, 0, 0)，即 identityCFrame 的 rightVector。理想情况下，这两者完全相等，但正如上文所提到的，产生细微区别的原因是由于浮点数学运算的误差。</p>
<h3>CFrame:VectorToWorldSpace()</h3>
<p>等同于 <code>(CFrame-CFrame.p) * v3</code></p>
<p>此方法的替代形式是 <code>CFrame * v3 - CFrame.p</code>。也就是说，此方法其实与 <code>CFrame:pointWorldSpace(v3)</code> 相差无几，但并不会添加 CFrame.p（如我们在 CFrame * v3 一节中所学到的）。</p>
<pre><code class="language-lua">local cf = CFrame.new(1, 2, 3) * CFrame.Angles(math.rad(14), math.rad(72), math.rad(-32))

print(cf:vectorToWorldSpace(Vector3.new(1, 0, 0)))
print(cf * Vector3.new(1, 0, 0) - cf.p)
print(cf.rightVector)
</code></pre>
<pre><code>0.262061268, -0.319058299, -0.910783052
0.262061238, -0.319058299, -0.910783052
0.262061268, -0.319058299, -0.910783052
</code></pre>

      </div>
    
  



              
            </div>

            
            
            
  <div class="related-articles" data-swiftype-index='false'>
    <h2 data-toc-skip class="text-center mbl">相关参考文章</h2>
    <div class="row">
      
        <div class="col-md-4">
          <a href="/articles/Understanding-CFrame"><span class="related-article-img" style="background-image: url(https://dk135eecbplh9.cloudfront.net/assets/blt4ff353a3211e0d11/Understanding-CFrames-Thumbnail.png);"> </span></a>
          <h3 data-toc-skip><a href="/articles/Understanding-CFrame">了解 CFrame</a></h3>
        </div>
      
    </div>
  </div>


          </div>
        </main>
      </div>
    </div>
    
  

  
  


<!-- Modal -->
<div class="modal gdpr-modal custom-modal" id="gdpr-modal" tabindex="-1" role="dialog" data-swiftype-index='false'>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <h1>此网站如何使用 Cookie</h1>
        <div class="privacy-content">
          <p>此平台使用 Cookie 为您提供更好的体验、对内容进行个性化、提供社交媒体功能和分析网站流量。如需详细信息（包括有关如何在此平台上防止使用 Cookie 或对其进行管理的信息），请参阅我们的<a href="https://en.help.roblox.com/hc/en-us/articles/115004630823-Roblox-Privacy-and-Cookie-Policy" target="_blank">隐私和 Cookie 政策</a>。</p>
        </div>
      </div>
      <div class="modal-footer">
        <a href="javascript:void(0)" class="btn" data-dismiss="modal">确定</a>
      </div>
    </div>
  </div>
</div>

  <!-- Modal -->
<div class="modal external-page-modal custom-modal" id="external-page-modal" tabindex="-1" role="dialog" data-swiftype-index=false>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="modal-header-text">你即将离开 Roblox 网站</div>
        <p>请按下继续按钮前往： <span class="link"></span></p>
      </div>
      <div class="modal-footer">
        <a href="" class="btn secondary-btn" data-dismiss="modal">返回</a>
        <a href="" class="btn primary-btn continue-link" target="_blank">继续</a>
      </div>
    </div>
  </div>
</div>

  <footer class="footer no-print" data-swiftype-index='false'>
    <div class="footer-info">
      <div class="row">
        <div class="col-12 col-sm-12 col-md-6 col-xl-7">
          <div class="info">
            <a href="https://www.roblox.com" target="_self" class="footer-logo ptxl mbl">
              <img src="https://dk135eecbplh9.cloudfront.net/assets/blt045a822d589ff524/roblox.png" alt="Roblox" title="Roblox">
            </a>
            <p>© 2019 Roblox Corporation. 保留所有权利。</p>
            <p class="mtxl mbl">
              
            </p>
            <ul class="social-links pbxl">
              
                <li>
                  <a href="https://twitter.com/robloxdevrel" target="_blank" class="social-icon">
                    <img src="https://dk135eecbplh9.cloudfront.net/assets/blt9999b06df576d2a8/twitter.svg"/>
                  </a>
                </li>
              
                <li>
                  <a href="https://www.facebook.com/Roblox" target="_blank" class="social-icon">
                    <img src="https://dk135eecbplh9.cloudfront.net/assets/bltb204a8ba683501db/facebook.svg"/>
                  </a>
                </li>
              
                <li>
                  <a href="https://www.linkedin.com/company/roblox/" target="_blank" class="social-icon">
                    <img src="https://dk135eecbplh9.cloudfront.net/assets/blt17f9ce2758f959da/linkedin.svg"/>
                  </a>
                </li>
              
                <li>
                  <a href="https://www.instagram.com/Roblox/" target="_blank" class="social-icon">
                    <img src="https://dk135eecbplh9.cloudfront.net/assets/bltd4faf9ad9e4b5923/instagram.svg"/>
                  </a>
                </li>
              
                <li>
                  <a href="https://www.twitch.tv/roblox" target="_blank" class="social-icon">
                    <img src="https://dk135eecbplh9.cloudfront.net/assets/blt96661fab5f032a0f/twitch.svg"/>
                  </a>
                </li>
              
                <li>
                  <a href="https://www.youtube.com/channel/UCjiPEaapiHbJMoAdi_L8fNA" target="_blank" class="social-icon">
                    <img src="https://dk135eecbplh9.cloudfront.net/assets/blt7f204f65c7c3c1dd/youtube.svg"/>
                  </a>
                </li>
              
            </ul>

            

<div class="language-dropdown">
  <div class="input-group-btn" id="input-group-btn">
    <button type="button" class="input-dropdown-btn" data-toggle="dropdown" id="input-dropdown-btn">
      <span class="icon-globe" id="icon-globe"></span>
      <span class="rbx-selection-label" data-bind="label" id="rbx-selection-label">English</span>
      <span class="icon-down-16x16"></span>
    </button>
    <ul data-toggle="dropdown-menu" class="dropdown-menu" role="menu">
      
      <li><a class="locale-option" data-locale="en-us">English</a></li>
      
      <li><a class="locale-option" data-locale="zh-cn">中文(简体)</a></li>
      
    </ul>
  </div>
</div>


          </div>
        </div>
        
          
            <div class="col-6 col-sm-6 col-md-3 col-xl-2 company">
          
              <h5 data-toc-skip>公司</h5>
              <ul class="links-list">
                
                  <li>
                    <a href="https://corp.roblox.com/" target="_blank">关于 Roblox</a>
                  </li>
                
                  <li>
                    <a href="https://corp.roblox.com/careers/" target="_blank">招贤纳士</a>
                  </li>
                
                  <li>
                    <a href="https://corp.roblox.com/technology/" target="_self">技术</a>
                  </li>
                
                  <li>
                    <a href="https://en.help.roblox.com/hc/en-us/articles/115004647846-Roblox-Terms-of-Use" target="_self">服务条款</a>
                  </li>
                
                  <li>
                    <a href="https://en.help.roblox.com/hc/en-us/articles/115004630823-Roblox-Privacy-and-Cookie-Policy" target="_blank">隐私政策</a>
                  </li>
                
                  <li>
                    <a href="https://corp.roblox.com/parents/" target="_self">家长</a>
                  </li>
                
              </ul>
            </div>
        
          
            <div class="col-6 col-sm-6 col-md-3 col-xl-3 developers">
          
              <h5 data-toc-skip>开发人员</h5>
              <ul class="links-list">
                
                  <li>
                    <a href="/articles/Creating-Your-First-Game" target="_self">入门</a>
                  </li>
                
                  <li>
                    <a href="/learn-roblox/all-tutorials" target="_self">了解</a>
                  </li>
                
                  <li>
                    <a href="/api-reference" target="_self">API 参考</a>
                  </li>
                
                  <li>
                    <a href="https://devforum.roblox.com" target="_blank">社区</a>
                  </li>
                
                  <li>
                    <a href="https://devforum.roblox.com/c/public/public-updates-announcements" target="_self">开发人员公告</a>
                  </li>
                
              </ul>
            </div>
        
      </div>
    </div>
  </footer>




  </div>

    <div class="modal fade" id="live-search-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header d-flex align-items-stretch">
                <label class="sr-only" for="st-live-search-input">搜索</label>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <div class="input-group-text border-0 rounded-0"><i class="fa fa-search" aria-hidden="true"></i>
                        </div>
                    </div>
                    <input class="form-control border-0 rounded-0" name="q" type="search" id="st-live-search-input"
                        placeholder="搜索">
                </div>
                <button type="button" class="btn btn-primary ml-3" data-dismiss="modal" aria-label="Close">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-body">
                <ul class="nav nav-tabs" id="live-search-result-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="all-results-tab" data-toggle="tab" href="#all" role="tab"
                            aria-selected="true" data-name="all_results">
                            所有结果
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="api-doc-results-tab" data-toggle="tab" href="#api-doc" role="tab"
                            aria-selected="false" data-name="api_reference">
                            API 文档
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="tutorial-results-tab" data-toggle="tab" href="#tutorial" role="tab"
                            aria-selected="false" data-name="articles">
                            教程
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="recipe-results-tab" data-toggle="tab" href="#recipe" role="tab"
                            aria-selected="false" data-name="recipes">
                            代码参考
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="video-results-tab" data-toggle="tab" href="#video" role="tab"
                            aria-selected="false" data-name="videos">
                            视频
                        </a>
                    </li>
                </ul>
                <div class="tab-content" id="live-search-result-tab-content">
                    <div class="search-container live-search-result mt-3"></div>
                </div>
            </div>
        </div>
    </div>
</div>

    <script>
      
    </script>
    <style>
      
    </style>
  </body>
</html>
